---
import { supabase } from '../../lib/supabase';
import UserMenu from '../ui/UserMenu';

// Obtener la sesiÃ³n y la tienda
const { data: { session } } = await supabase.auth.getSession();

let store = null;
if (session) {
  const { data } = await supabase
    .from('stores')
    .select('*')
    .eq('user_id', session.user.id)
    .single();
  store = data;
}

// #region agent log
fetch('http://127.0.0.1:7242/ingest/b0f55e3a-8eac-449f-96b7-3ed570a5511d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({sessionId:'debug-session',runId:'pre-fix',hypothesisId:'H2',location:'src/components/dashboard/Navbar.astro:11',message:'Navbar session and store loaded',data:{hasSession:!!session,storeId:store?.id},timestamp:Date.now()})}).catch(()=>{});
// #endregion
---

<nav class="bg-white border-b">
  <div class="container mx-auto px-4">
    <div class="flex justify-between items-center h-16">
      <!-- Logo -->
      <a href="/" class="text-xl font-bold text-gray-800">
        Mi Tienda Online
      </a>

      <!-- Navigation -->
      <UserMenu client:load store={store} />
    </div>
  </div>
</nav> 